<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <link rel="shortcut icon" typ="x-icon" href="img/NoxiusLogoCrop.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> NOXIUS | Inventory </title>
    <link rel="stylesheet" href="inventory.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <header class="header">
    <div id="username-display" class="username-display"></div>
    <!-- Hamburger Button -->
    <button class="hamburger" id="hamburger">&#9776;</button>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <img src="img/NoxiusLogoCrop.png" alt="Logo" class="sidebar-logo">
            <button class="close-btn" id="closeSidebar">&times;</button>
        </div>
        <ul class="sidebar-menu">
            <li><a href="dashboard.html"><i class="fas fa-home"></i> Dashboard</a></li>
            <li><a href="inventory.html"><i class="fas fa-boxes"></i> Manajemen Inventory</a></li>
            <li><a href="penjualan.html"><i class="fas fa-cash-register"></i> Penjualan & POS</a></li>
            <li><a href="analisis.html"><i class="fas fa-chart-line"></i> Analisis Keuangan</a></li>
            <li><a href="karyawan.html"><i class="fas fa-users"></i> Manajemen Karyawan</a></li>
            <li><a href="NoxAi.html"><img src="img/NoxAiLogo.png" alt="NoxAI" class="sidebar-icon"> NoxAI Chat</a></li>
        </ul>
        <div class="sidebar-footer">
            <a href="login.html" class="login-btn">Login / Register</a>
        </div>
    </div>
    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>


    </header>

    <main class="container">
         <div class="container">
            <h1><i class="fas fa-boxes"></i> Manajemen Inventori</h1>
            <p>Track stok barang secara real-time. Hindari kekurangan atau kelebihan stok.</p>
        </div>
    <!-- Menambahkan File Excel -->
    <section class="upload-section">
        <h4>Masukkan file excel :</h4>
        <label for="excelFile" class="file-choose-btn"><i class="fas fa-file"></i> Pilih File Excel</label>
        <input type="file" id="excelFile" accept=".xlsx, .xls" style="display: none;">
        <button id="uploadBtn" class="btn-primary"><i class="fas fa-upload"></i> Upload Excel</button>
    </section>
        <!-- Tombol Tambah Barang -->
        <section class="add-section">
            <button id="addBtn" class="btn-primary"><i class="fas fa-plus"></i> Tambah Barang Baru</button>
            <button id="resetBtn" class="btn-secondary"><i class="fas fa-trash"></i> Hapus Semua </button>
        </section>

        <!-- Form Untuk Tambah/Edit Barang (Hidden awalnya) -->
        <section id="formSection" class="form-section hidden">
            <h2 id="formTitle">Tambah Barang Baru</h2>
            <form id="inventoryForm">
                <input type="hidden" id="editId">
                <div class="form-group">
                    <label for="nama">Nama Barang:</label>
                    <input type="text" id="nama" placeholder="Contoh: Beras" required>
                </div>
                <div class="form-group">
                    <label for="harga">Harga per Unit (Rp):</label>
                    <input type="number" id="harga" min="0" placeholder="10000" required>
                </div>
                <div class="form-group">
                    <label for="stok">Stok Saat Ini:</label>
                    <input type="number" id="stok" min="0" placeholder="0" required>
                </div>
                <div class="form-group">
                    <label for="minStok">Batas Minimum Stok (Hijau jika < barang):</label>
                    <input type="number" id="minStok" min="0" value="10" required>
                </div>
                <div class="form-group">
                    <label for="maxStok">Batas Maksimum Stok (Merah jika > barang):</label>
                    <input type="number" id="maxStok" min="1" value="100" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn-primary">Simpan</button>
                    <button type="button" id="cancelBtn" class="btn-secondary">Batal</button>
                </div>
            </form>
        </section>

        <!-- Daftar Inventori -->
        <section class="inventory-section">
            <h2>Daftar Barang</h2>
            <div id="inventoryList" class="inventory-grid">
                <!-- Barang akan di-tampilkan di bagian ini -->
            </div>
            <p id="emptyMsg" class="empty-message hidden">Belum ada barang. Tambahkan yang pertama!</p>
        </section>
    </main>

    <!-- SVG Untuk Memunculkan Efek Gelombang -->
     <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="#5000ca" fill-opacity="1" d="M0,0L34.3,10.7C68.6,21,137,43,206,64C274.3,85,343,107,411,112C480,117,549,107,617,96C685.7,85,754,75,823,85.3C891.4,96,960,128,1029,149.3C1097.1,171,1166,181,1234,170.7C1302.9,160,1371,128,1406,112L1440,96L1440,320L1405.7,320C1371.4,320,1303,320,1234,320C1165.7,320,1097,320,1029,320C960,320,891,320,823,320C754.3,320,686,320,617,320C548.6,320,480,320,411,320C342.9,320,274,320,206,320C137.1,320,69,320,34,320L0,320Z"></path></svg>
    <section id="kontak">
    <footer>
        <aside>
          <p>&copy; Copyright 2025 by <span>Muhammad Akhdan.</span></p>
        </aside>
    </footer>
    </section>
</main>

    <script src="inventory.js"></script>
<script>
// Upload Excel ke backend AI
const excelFile = document.getElementById('excelFile');
const uploadBtn = document.getElementById('uploadBtn');

// Cek apakah halaman diakses via HTTP (server running)
if (window.location.protocol === 'file:') {
    uploadBtn.disabled = true;
    uploadBtn.textContent = 'Server Tidak Berjalan';
    uploadBtn.style.backgroundColor = '#ccc';
    uploadBtn.style.cursor = 'not-allowed';
    const warning = document.createElement('p');
    warning.textContent = 'Untuk menggunakan fitur upload, jalankan "python inventory.py" dan akses via http://localhost:5000/';
    warning.style.color = 'red';
    warning.style.fontSize = '14px';
    document.querySelector('.upload-section').appendChild(warning);
}

uploadBtn.addEventListener('click', () => {
    if (window.location.protocol === 'file:') {
        alert('Silakan jalankan server Flask dengan menjalankan "python inventory.py" dan akses halaman via http://localhost:5000/');
        return;
    }
    const file = excelFile.files[0];
    if (!file) {
        alert('Pilih file Excel terlebih dahulu!');
        return;
    }
    const formData = new FormData();
    formData.append('file', file);

    fetch('/upload', {
        method: 'POST',
        body: formData
    })
    .then(res => res.json())
    .then(data => {
        if (data.error) {
            alert('Error: ' + data.error);
            return;
        }
        // Gabungkan dengan data yang sudah ada
        let existingInventory = JSON.parse(localStorage.getItem('inventory')) || [];
        let mergedInventory = existingInventory.concat(data);
        localStorage.setItem('inventory', JSON.stringify(mergedInventory));
        inventory = mergedInventory;
        renderInventory();
        excelFile.value = '';
    })
    .catch(err => {
        alert('Gagal mengirim file: ' + err.message);
    });
});
</script>


</body>
</html>
